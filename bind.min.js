export default class{constructor(){this.initialDOM=[],this.currentDOM=[],this.lastUpdate={}}getVarLength(t){return Object.keys(t).length}getVarData(t,e){const a=Object.keys(t)[e];return{name:a,value:"function"==typeof t[a]?t[a]():t[a]}}htmlValue(t){return"{{"+t+"}}"}render(t,e,a){const n=document.querySelector(t);this.initialDOM=Array.from(n.cloneNode(!0).getElementsByTagName("*")),this.currentDOM=Array.from(n.getElementsByTagName("*")),"function"==typeof a&&a(),this.updateDOM(e),setInterval((()=>{for(let t=0;t<this.getVarLength(e);t++){const a=this.getVarData(e,t);this.lastUpdate[t]&&this.lastUpdate[t].value!==a.value&&(console.log(`updating ${a.name}`),this.updatePropertyInDOM(e,a.name)),this.lastUpdate[t]={value:a.value}}}),0)}updatePropertyInDOM(t,e){this.initialDOM.forEach(((a,n)=>{for(let r=0;r<this.getVarLength(t);r++){const i=this.getVarData(t,r);a.innerHTML.includes(this.htmlValue(e))&&a.innerHTML.includes(this.htmlValue(i.name))&&0===a.children.length&&(this.currentDOM[n].innerHTML=a.innerHTML.replace(this.htmlValue(i.name),i.value))}}))}updateDOM(t){this.initialDOM.forEach(((e,a)=>{for(let n=0;n<this.getVarLength(t);n++){const r=this.getVarData(t,n);e.innerHTML.includes(this.htmlValue(r.name))&&0===e.children.length&&(this.currentDOM[a].innerHTML=e.innerHTML.replace(this.htmlValue(r.name),r.value))}}))}}